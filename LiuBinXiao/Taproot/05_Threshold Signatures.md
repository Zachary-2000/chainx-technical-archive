# Threshold Signatures

What is a threshold signature? In short, a threshold signature scheme is a method of replacing a digital signature scheme with an interactive protocol between multiple parties that includes both a key generation and a signature algorithm. The key generation protocol involves a set of n parties that interactively generate an m-out-of-n secret sharing of keys. Unlike standard secret sharing, this is not achieved by generating the key locally and sharing it among the parties. Instead, the keys are generated directly in a shared manner, so that a subset of fewer than m parties will not have any information about the keys. Next, the signature algorithm is replaced with an interaction protocol to generate signatures. Suppose there is a set of n nodes in total and a threshold of t. Then at least t nodes must interact for signing to generate a valid signature.

## Secure Threshold Signatures

Since a subset of fewer than m nodes cannot generate a usable signature, if a node agrees to sign on a transfer of a sum of money to an entity, then even if some participants are malicious, they cannot transfer a different sum of money, or transfer it to someone else, or generate additional transfers later. Only transactions agreed to by more than a threshold number of nodes can be executed properly. Threshold signatures also provide flexibility in defining signable persons, which means that it is possible to set different numbers of legitimate signers for different amounts of money. For example, it is possible to set a small number of people for protecting smaller amounts of money (less decentralized, faster signatures, low security) and a large number of people for protecting larger amounts (more decentralized, slightly fuller signatures, high security).

## Active refreshing of shared secrets

In a threshold signature scheme, each party holds a share of the private key, and any number of people who meet the threshold can generate a signature, so any multiple parties entitled to participate in the signature can combine to define the private key, in which there can exist a party that will slowly bribe the parties that jointly hold a share, and over time, that party may steal enough shares to reconstruct the private key. The purpose of refreshing is to achieve active security, which means that an adversary must simultaneously crack enough shares to gain access to the information. Specifically for implementation, a fixed time interval can be set in which the adversary must crack the shares that reach a threshold value or it will get nothing. This difficulty of cracking a fixed number of keys in a fixed time is much greater than cracking a fixed number of keys over a while, especially when the time tends to be in a relatively small range and cracking is almost impossible.

Now, to take a brief look at how to do the refresh. This is quite simple. First, the m-out-of-n secret sharing of private key k is generated by defining a polynomial f of random number - (m-1) such that f(0) = k and the i-th party (for i = 1,...,n) receives the share f(i). Any m points on the (m-1)-order polynomial are sufficient to reconstruct the polynomial and thus the secret. This means that if all parties hold the same shares over time, then an attacker slowly steals share after share and can gain access to the secret. To prevent this, we want the parties to generate a new share of the same secret with a new polynomial at the end of each interval so that the previous shares are useless (since the previous shares belong to a different polynomial and they are meaningless after this operation). Without going into details on how to generate it, the most elegant way to generate this new share with a different polynomial is for the parties to jointly generate a share with a random number-(m-1) polynomial g such that g (0) = 0. Then, given g (i) and f (i), the i-th party locally computes its new share as f'(i) = f (i) + g (i).

## Dynamic Threshold Signatures

Threshold signatures are a very good solution, but in practice, we need to consider more cases. For example, it should be a normal case that someone may drop out or join a new person in the threshold signature group, and this is a necessary feature, otherwise, it would be too stupid to transfer the cryptocurrency to a new address every time someone changes in the signature group, and this operation is not feasible. Of course, it is easy to implement a dynamic share assignment, just provide the people in the signature group with their share f(j), where j represents their identity (or ID), and then it can be easily implemented by the refresh operation mentioned above, after which the previous share becomes invalid, and at the same time, the share will be reassigned to implement dynamic threshold signatures.

## Multi-signatures and threshold signatures

A multi-signature, in cryptocurrency, is essentially a signature consisting of multiple signatures that are verified against a given number of signatures. For example, a 2-out-of-3 multi-signature is defined with three public keys, and the verification script will use two of these three public keys to verify that two signatures are valid when they are on the same message. Technically, a multi-signature is the reverse of a threshold signature, so why? First, look at threshold signatures. In threshold signatures, the key generation and signing procedures are modified, but the verification procedures are unchanged. Conversely, in multiple signatures, the procedures for key generation and signing are the same, but the procedures for verifying the signatures are modified so that multiple signatures can be verified. From this perspective, multiple signatures and threshold signatures are just different means to achieve the same goal, i.e., a certain number of people must be present to generate a valid signature and they need to be generated each time. Of course, they still differ in several ways.

1. Complexity: In cryptography, multiple signatures are much simpler than threshold signatures, especially since multiple signatures do not change much in key generation and signatures. The only thing to note is that a small amount of code is needed to verify multiple signatures and check if a certain number of people are satisfied, while threshold signature schemes are more advanced cryptographic protocols that require sufficient expertise to design and deploy.
2. Multiple signature support. A threshold signature scheme generates the same standard signature as a normally generated signature, and for blockchains, it is not even known that the signature is generated especially. In contrast, multi-signatures need to be verified differently, so they must be specifically supported by the platform, as not all cryptocurrencies support multi-signatures, which can be a problem. In addition, multi-signatures have a higher cost, and the more people involved in the signature the higher the cost will be.
3. Active refreshing. Threshold signatures support refreshing shares to prevent gradual theft of shares. Multiple signatures do not support this because each key is held intact and cannot be changed without transferring funds. As a result, there is no mitigation for an attacker slowly stealing each key over a long period.
4. Dynamic thresholds. Again, threshold signatures support removing and adding shares of held keys. In contrast, multiple signatures do not support this. If we want to modify a quorum from 2-3 to 2-4 (because a new signer joins the group), then when using multiple signatures, we must transfer the funds to the new structure. Similarly, deleting an employee and changing the number of signatories from 2-out-of-4 to 2-out-of-3 requires a transfer of funds. Finally, replacing one of them with another person also requires changing the key and thus transferring the funds, otherwise, the previous person still has the right to sign.

## Summary

In summary, while threshold signatures and multi-signatures solve the same basic problem, threshold signatures have many advantages over multi-signatures. The main advantage of multi-signature is that it is very simple and does not require any special cryptographic expertise to build and deploy.